version: 2.1

jobs:
  deploy:
    docker:
      - image: amazon/aws-cli
    steps:
      - checkout
      - run:
          name: cloudfront
          command: |
            ls
            aws cloudformation deploy \
              --template-file cloudfront.yml \
              --stack-name udapeople-stack
            --parameter-overrides WorkspaceID="TESTE"
      - run:
          name: Infrastructure
          command: |
            ls
            aws cloudformation deploy \
              --template-file backend.yml \
              --stack-name udapeople-stack
              --parameter-overrides ID="TESTE"


workflows:
  default:
    jobs:
      - deploy
